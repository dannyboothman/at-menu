!function(t,e){"function"==typeof define&&define.amd?define([],e(t)):"object"==typeof exports?module.exports=e(t):t.AtMenu=e(t)}("undefined"!=typeof global?global:this.window||this.global,function(t){"use strict";var e={},r={target:"",menu:"",openMenu:"@",closeMenu:"Escape",marginTop:20},n=function(){var t={},e=!1,r=0,i=arguments.length;for("[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],r++);r<i;r++){var o=arguments[r];!function(r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e&&"[object Object]"===Object.prototype.toString.call(r[i])?t[i]=n(!0,t[i],r[i]):t[i]=r[i])}(o)}return t},i=function(t,e){e.code==t.closeMenu&&t.menu.classList.remove("atm-menu-active")},o=function(t){t.menu.classList.remove("atm-menu-active")},a=function(t,e){let n=t.target.value,i=t.target.selectionStart;if(n[i-1]===t.openMenu){var o=AtMenu.getCaretPosition(t.target),a=r.marginTop;t.marginTop&&(a=t.marginTop),t.menu.style.top=o.caret.top+o.target.top+o.html+a+"px",t.menu.style.left=o.caret.left+o.target.left+"px",t.menu.classList.add("atm-menu-active")}},s=function(t,e){if(8==e.keyCode||"Backspace"==e.key){let r=t.target.value,n=t.target.selectionStart;r[n-1]===t.openMenu&&o(t)}};return e.getCaretPosition=function(t){var e;return{caret:$(t).textareaHelper("caretPos"),target:t.getBoundingClientRect(),html:document.querySelector("html").scrollTop}},e.init=function(t){var e=n(r,t||{});e.target.addEventListener("input",function(t){a(e,t)},!1),e.target.addEventListener("keydown",function(t){i(e,t),s(e,t)},!1)},e}),function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){"use strict";var e="textarea-helper-caret",r="textarea-helper",n=["box-sizing","height","width","padding-bottom","padding-left","padding-right","padding-top","font-family","font-size","font-style","font-variant","font-weight","word-spacing","letter-spacing","line-height","text-decoration","text-indent","text-transform","direction"],i=function(e){"textarea"===e.nodeName.toLowerCase()&&(this.$text=t(e),this.$mirror=t("<div/>").css({position:"absolute",overflow:"auto","white-space":"pre-wrap","word-wrap":"break-word",top:0,left:-9999}).insertAfter(this.$text))};(function(){this.update=function(){for(var r,i={},o=0;r=n[o];o++)i[r]=this.$text.css(r);this.$mirror.css(i).empty();var a=this.getOriginalCaretPos(),s=this.$text.val(),c=document.createTextNode(s.substring(0,a)),u=document.createTextNode(s.substring(a)),l=t("<span/>").addClass(e).css("position","absolute").html("&nbsp;");this.$mirror.append(c,l,u).scrollTop(this.$text.scrollTop())},this.destroy=function(){return this.$mirror.remove(),this.$text.removeData(r),null},this.caretPos=function(){this.update();var t=this.$mirror.find("."+e),r=t.position();return"rtl"===this.$text.css("direction")&&(r.right=this.$mirror.innerWidth()-r.left-t.width(),r.left="auto"),r},this.height=function(){return this.update(),this.$mirror.css("height",""),this.$mirror.height()},this.getOriginalCaretPos=function(){var t=this.$text[0];if(t.selectionStart)return t.selectionStart;if(document.selection){t.focus();var e=document.selection.createRange();if(null==e)return 0;var r=t.createTextRange(),n=r.duplicate();return r.moveToBookmark(e.getBookmark()),n.setEndPoint("EndToStart",r),n.text.length}return 0}}).call(i.prototype),t.fn.textareaHelper=function(e){return(this.each(function(){var e=t(this),n=e.data(r);n||(n=new i(this),e.data(r,n))}),e)?this.first().data(r)[e]():this}});